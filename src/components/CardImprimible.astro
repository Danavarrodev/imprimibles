---
import { Image } from 'astro:assets';

const {
  title,
  description,
  cover,
  subject,
  level,
  slug,
  pdf,
  eager = false,
} = Astro.props;
---

<article
  class="group rounded-xl border border-gray-200 bg-white shadow-sm hover:shadow-md transition overflow-hidden"
  data-title={title}
  data-subject={subject}
  data-level={level}
>
  <a href={`/imprimibles/${slug}/`} class="block">
    <div class="flex items-center justify-center bg-gray-50 rounded-t-xl min-h-[176px]">
      {cover ? (
        <Image
          src={cover}
          alt={title}
          width={600}
          height={400}
          fit="contain"
          loading={eager ? 'eager' : 'lazy'}        
          fetchpriority={eager ? 'high' : 'auto'}   
          sizes="(max-width:640px) 100vw, (max-width:1024px) 50vw, 33vw"
          class="max-h-[176px] w-auto"
        />
      ) : (
        <img
          src="/images/placeholder.svg"
          alt={title}
          width="600"
          height="400"
          loading="lazy"
          decoding="async"
          class="max-h-[176px] object-contain w-auto"
        />
      )}
    </div>

    <div class="p-4">
      <h3 class="text-base font-semibold text-gray-900 group-hover:underline">
        {title}
      </h3>
      <p class="mt-1 text-sm text-gray-600 line-clamp-2">
        {description ?? 'Actividad imprimible.'}
      </p>

      <div class="mt-3 flex flex-wrap gap-2">
        {subject && (
          <span class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs text-gray-700">
            {subject}
          </span>
        )}
        {level && (
          <span class="inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5 text-xs text-gray-700">
            {level}
          </span>
        )}
      </div>

      <div class="mt-4 flex items-center gap-2">
        <span class="text-sm text-gray-500">Ver ficha</span>
        {pdf && (
          <a
            href={pdf.startsWith('/') ? pdf : '/' + pdf}
            class="text-sm underline hover:no-underline"
          >
            Descargar PDF
          </a>
        )}
      </div>
    </div>
  </a>
</article>
